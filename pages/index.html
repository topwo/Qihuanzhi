<!DOCTYPE>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link href="../css/global.css" rel="stylesheet">
    <link href="../css/normalize.css" rel="stylesheet">
    <script src="../js/jquery-3.1.0.min.js"></script>
    <script src="../framework/tran/work.js"></script>
    <script src="../framework/security/cookie.js"></script>
</head>
<body>
<div id="index">

<div id="div_announcement">
    <div id="div_announcement_alpha"></div>
    <iframe id='iframe_announcement' src="../pages/announcement.html"></iframe>
</div>

<script>
//$("#div_announcement").css('display', 'block')
getCookie('announcement_onoff') == null ? console.log('a') : console.log('b');

getData('user','nav-top-gold','gold');
getData('user','nav-top-fushi','fushi');

// 隐藏公告
$("#div_announcement_alpha").click(function(){
    $('#div_announcement').hide();
});

function getData(model,div,name)
{
    var worker = new Worker("../js/work.js");
    worker.postMessage( model );
    worker.onmessage = function(evt)
    {
        var result = jQuery.parseJSON( evt.data );
        $("#"+div).text( result[name] );
    };
}
</script>

<div class="nav-top">
    <img id='nav-top-img' src="../img/ui/top.jpg" style="width:100%;">
    <div id='nav-top-gold'></div>
    <div id='nav-top-fushi'></div>
    <div id='nav-top-div'>
        <img id='nav-top-icon' src="../img/ui/mail.png">
        <img id='nav-top-icon' src="../img/ui/gift.png">
        <img id='nav-top-icon' src="../img/ui/message.png">
    </div>
</div>

<div id='iframe'></div>

<div class="nav-bottom">
    <img id="go_index" src="../img/ui/home.jpg" class="nav-img">
    <img src="../img/ui/instance.jpg" class="nav-img">
    <img id="go_battle" src="../img/ui/battle.jpg" class="nav-img">
    <img src="../img/ui/shop.jpg" class="nav-img">
    <img src="../img/ui/friend.jpg" class="nav-img">
    <img src="../img/ui/help.jpg" class="nav-img">
</div>

<script>
    $("#go_battle").click(function(){
        //getHtml('../pages/battle.php');
        //document.write($.ajax({url:"../pages/battle.php",async:false}).responseText);
    });
    $("#go_index").click(function(){
        var xmlhttp=new XMLHttpRequest();
        xmlhttp.open("GET","../pages/main.html",true);
        xmlhttp.send();
        xmlhttp.onreadystatechange=function()
        {
            if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                $('#iframe').html(xmlhttp.responseText);
            }
        }
    });

    window.onload=function()
    {
        // 已经看过公告
        setCookie('announcement_onoff','1');

        var xmlhttp=new XMLHttpRequest();
        xmlhttp.open("GET","../pages/main.html",true);
        xmlhttp.send();
        xmlhttp.onreadystatechange=function()
        {
            if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                $('#iframe').html(xmlhttp.responseText);
            }
        }
    }
</script>

</div>
</body>
</html>
